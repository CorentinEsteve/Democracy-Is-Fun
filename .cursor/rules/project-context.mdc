---
description: 
globs: 
alwaysApply: true
---
Votons Fun! ‚Äì Comprehensive Functional Specifications (English)

1. Overview  
A web platform (ReactJS frontend / NodeJS + Prisma backend) designed to help communities make collective decisions in a fun, fair, and interactive way. Users can join multiple communities to propose, discuss, vote, and coordinate activities.

Core Modules  
- Community management & roles  
- Chat (polling, with future real-time upgrade)  
- Activity proposals & dynamic voting  
- Collaborative notes  
- Integrated calendar & external sync  
- Gamification (points, leaderboards)

2. Users & Roles

| Role   | Main Permissions                                                                        |
|--------|-----------------------------------------------------------------------------------------|
| Admin  | ‚Ä¢ Create/archive communities  
‚Ä¢ Add/remove/promote/demote members  
‚Ä¢ Edit community settings (name, image, description)                                      |
| Member | ‚Ä¢ Propose activities  
‚Ä¢ Change and re-cast votes (üëç/üëé/‚úã)  
‚Ä¢ Use chat and notes  
‚Ä¢ View calendar & leaderboard                                        |

3. Data Models

1. User  
   - id, name, email, avatarUrl, createdAt, updatedAt  
2. Community  
   - id, name, description, imageUrl, creatorId, createdAt, updatedAt  
3. Membership  
   - userId, communityId, role (Admin/Member), points, joinedAt  
4. Proposal  
   - id, communityId, initiatorId, title, description, location, dateTime, tags[], deadline, quorumPct, status (Active/Approved/Rejected/Tied), parentProposalId  
5. Vote  
   - id, proposalId, voterId, voteType (For/Against/Neutral), votedAt  
6. Opposition (optional)  
   - id, originalProposalId, alternativeProposalId  
7. Note  
   - id, communityId, authorId, content, timestamp  
8. Event  
   - id, proposalId, communityId, title, dateTime, location, createdAt  
9. Message  
   - id, communityId, authorId, content, createdAt  

4. UI Layout

|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì‚Äì|
| [üîç Communities]            | [üí¨ Chat | üìÜ Calendar | üìù Notes]  | [üìá Proposals Tabs]    |
|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì‚Äì|

### 4.1. Left Panel: Communities

- Search bar to filter by name  
- Scrollable list, with ‚Äú+‚Äù to create a community  
- Selecting loads that community‚Äôs workspace

### 4.2. Center Panel: Chat / Calendar / Notes

**Chat** (polling)
- Message list with auto-generated proposal posts  
- MessageInput + ‚ÄúPropose‚Äù button opens proposal modal  

**Calendar**
- List or calendar grid of approved events  
- Each event card shows title, date/time, and ‚ÄúüìÖ‚Äù export button  

**Notes**
- Collaborative note list  
- Create/Edit/Delete via a modal  

### 4.3. Right Panel: Proposals Tabs

**Tabs: Active | Oppositions | Archived**

**Active**  
- Cards show title, initiator (avatar), location, date/time, tags  
- Countdown timer to deadline  
- Vote buttons üëç/üëé/‚úã (clickable anytime before close) with live counts  
- Quorum indicator (e.g. ‚Äú5/10 votes (quorum 80%)‚Äù)  
- Waiting-voters list  
- Glow: green=not voted, blue=voted & still active  
- Action buttons: ‚úèÔ∏è Edit (revision flow), ‚öîÔ∏è Oppose (alternative flow)  

**Oppositions**  
- Alternative proposals linked to an original  

**Archived**  
- Rejected or expired proposals (read-only)

5. Detailed Workflows

#### 5.1. Creating a Proposal
1. Click ‚Äú+ Propose‚Äù in Chat  
2. Popup: title, description, location, dateTime, tags, deadline (default 1wk), quorumPct (default 100%)  
3. Submit ‚Üí proposal appears in Active, auto-vote by initiator, chat post

#### 5.2. Voting Process
- Users can **change** their vote until close  
- Close triggers:
  - **Early**: insurmountable majority  
  - **Deadline**: quorumPct met + >50% majority  
  - **Tie**: remains Active until manual action  
- Status flips to Approved/Rejected

#### 5.3. Editing & Opposition
- **Edit**: opens pre-filled modal, creates a new linked revision  
- **Oppose**: creates an alternative proposal; both up for vote

#### 5.4. Post-Approval
1. Proposal ‚Üí Approved ‚úÖ  
2. Event record created  
3. ‚ÄúüìÖ‚Äù icon on card ‚Üí export ICS to Google/Outlook/iCloud  
4. Chat: ‚ÄúEvent approved: ‚Ä¶‚Äù auto-message  
5. Points: +10 to initiator; update leaderboard
6. Gamification
- **Points**: +10 for each approved proposal  
- **Leaderboard**: community details list sorted by points

7. UX & Accessibility
- Apple-inspired: clean, rounded corners, soft shadows  
- Popups close on outside click  
- Dark/Light mode toggle (future)  
- ARIA labels, keyboard nav, responsive layouts  
- Error states & friendly toasts for API errors

8. Next Enhancements (MVP+)
- **Deadline visualization** on cards  
- **Tie/Early close logic** in UI & backend  
- **Archived/Oppositions** tabs UI  
- **Real-time chat** via WebSockets  
- **Leaderboards** page  
- **Form validations** & empty states  
- **End-to-end tests** for core flows  
- **Advanced filters**, @mentions, calendar sync, vote delegation
