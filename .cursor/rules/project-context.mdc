---
description: 
globs: 
alwaysApply: true
---
Votons Fun! ‚Äì Comprehensive Functional Specifications (English)

1. Overview
Purpose  
A web platform (ReactJS frontend / NodeJS + Prisma backend) designed to help communities make collective decisions in a fun, fair, and interactive way. Users can join multiple communities to propose, discuss, and vote on activities.

Core Modules  
- Community management & roles  
- Real-time chat  
- Activity proposals & dynamic voting  
- Collaborative notes  
- Integrated calendar & external sync  
- Gamification (points, leaderboards)

2. Users & Roles

| Role   | Main Permissions                                                                        |
|--------|-----------------------------------------------------------------------------------------|
| Admin  | ‚Ä¢ Create/archive communities  
‚Ä¢ Add/remove members  
‚Ä¢ Promote/demote other admins  
‚Ä¢ Edit community settings (name, image, description)                                      |
| Member | ‚Ä¢ Propose activities  
‚Ä¢ Vote (üëç/üëé/‚úã)  
‚Ä¢ Use chat and notes  
‚Ä¢ View calendar & leaderboard                                        |

Community Creation  
- Fields: name, description, group image, initial member list (invite link or search)  
- Creator defaults to Admin

3. Data Models (Key Entities)

1. User  
   - id, name, email, avatarUrl, etc.
2. Community  
   - id, name, description, imageUrl, creatorId
3. Membership  
   - userId, communityId, role (Admin/Member), points
4. Proposal  
   - id, communityId, initiatorId, title, description, location, dateTime, tags[], deadline, quorumPct, status (Active/Approved/Rejected), parentProposalId
5. Vote  
   - id, proposalId, voterId, voteType (For/Against/Neutral)
6. Opposition  
   - id, originalProposalId, alternativeProposalId
7. Note  
   - id, communityId, authorId, content, timestamp
8. Event  
   - id, proposalId, communityId, title, dateTime, location

4. UI Layout

|------------------------------------------------------------------------|
| [üîç + Communities] | [üí¨ Chat | üìÜ Calendar | üìù Notes] | [üìá Proposals] |
|------------------------------------------------------------------------|

4.1. Left Panel: Communities
- Search bar to filter by name  
- Scrollable list of communities the user belongs to  
- + button to create a new community  
- Selecting a community loads its workspace in the center and right panels

4.2. Center Panel: Chat / Calendar / Notes
- Tabs at the top: Chat / Calendar / Notes

Chat  
- Real-time message feed  
- Auto-generated message for each proposal:  
  "Proposal by Alex: Hiking at 3 PM (Tag: Outdoors)"  
- Message input field + + Propose button

Calendar  
- Monthly & weekly views of approved events  
- Clicking an event opens a details popup with a button to export to Google/Outlook/iCloud

Notes  
- Collaborative text area (free-form text, bullet lists)  
- Real-time saving

4.3. Right Panel: Proposals
- Tabs: Active / Oppositions / Archived

Active Proposals
- Compact cards displaying: title, initiator (+ avatar), location, date/time, tags (badges)  
- Deadline timer (countdown)  
- Vote buttons: üëç / üëé / ‚úã (neutral), with live counters  
  - Initiator automatically casts a üëç on creation  
- Waiting voters list at the bottom (avatars or names) to show who hasn't voted yet  
- Quorum: minimum vote participation percentage (set at creation)  
- Early close: if an insurmountable majority is reached before the deadline, close the vote immediately  
- Tie handling: if votes are tied at deadline, leave the proposal active until manual action  
- Action buttons: ‚úèÔ∏è Edit (opens pre-filled popup, creating a linked revision) and ‚öîÔ∏è Oppose (create an alternative proposal)  
- Visual cues: green glow for proposals not yet voted by the user; blue glow for proposals currently in voting

Oppositions
- List of alternative proposals linked to the original  
- Same card layout and voting mechanics to determine final winner

Archived
- Proposals that were rejected by majority or expired by deadline  
- Read-only, no voting allowed

5. Detailed Workflows

5.1. Creating a Proposal
1. Click + Propose in Chat tab  
2. Display popup with fields: title, description, location, date/time, tags, deadline (default: 1 week), quorumPct (default: 100%)  
3. Submit: the proposal appears in Active tab, initiator auto-votes üëç, and an auto-message posts in chat

5.2. Voting Process
1. Members vote (üëç, üëé, or ‚úã) until deadline expiry or early close  
2. Vote closes when either:  
   - Early close: insurmountable majority is reached  
   - Deadline reached AND quorumPct and >50% majority of votes cast  
3. Status becomes Approved or Rejected accordingly  
4. In case of a tie at deadline, proposal remains Active until edited or removed

5.3. Editing & Opposition
- Edit: clicking ‚úèÔ∏è opens the pre-filled popup; submitting creates a new linked proposal revision  
- Opposition: clicking ‚öîÔ∏è generates an alternative proposal; both original and alternative are put to vote

5.4. Post-Approval
1. Status switches to Approved ‚úÖ  
2. Event created in the integrated calendar  
3. üìÖ icon appears on the approved card for export to Google Calendar, Outlook, or iCloud  
4. Auto-chat message: "Event approved: <Title> on <Date> ‚Äì added to your calendar"  
5. Initiator receives 10 points; leaderboard updates

6. Gamification
- Points: +10 for each approved proposal  
- Leaderboard: top contributors highlighted in community details (profile avatars + points)

7. UX & Accessibility
- Apple-inspired design: clean layouts, rounded corners, light drop shadows, San Francisco-like font  
- Popups closable by clicking outside or using the close button  
- Dark/Light modes with smooth transitions  
- Subtle micro-interactions for hover and click feedback  
- Full ARIA labeling, keyboard navigation, adjustable font sizes

8. Future Enhancements (MVP+)
- Mid-deadline visual reminders  
- Online presence indicators (active status)  
- Inline statistics & insights (proposals per tag, participation rates)  
- Advanced filters (by tag, date, initiator)  
- @mentions & #hashtags support in chat and notes  
- Automatic archiving (e.g., proposals older than 1 year)  
- CSV export of proposals and vote results  
- Bidirectional calendar sync  
- Vote delegation feature ("vote for me")
